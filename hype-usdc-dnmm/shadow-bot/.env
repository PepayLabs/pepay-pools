# Shadow Bot Enterprise Configuration for HYPE/USDC DNMM
# Generated: 2025-09-28
# Market: HYPE/USDC on Hyperliquid

# ==============================================================================
# NETWORK CONFIGURATION
# ==============================================================================

# HyperEVM RPC endpoint (Alchemy)
RPC_URL=https://hyperliquid-mainnet.g.alchemy.com/v2/fv3Xkbau-eS8pS3SV3e6s

# DNMM pool contract address (optional - loads config from chain if provided)
DNMM_POOL_ADDRESS=

# Oracle source selection
USE_SPOT=true  # true for spot @107, false for perp @159

# Market key for HyperCore oracles (auto-selected based on USE_SPOT)
# Spot pair @107: HYPE/USDC (tokens [150, 0]) - uses custom encoding
# Perp index 159: HYPE perp - uses standard scaling
MARKET_KEY_DEC=107

# HyperCore price decimals (auto-selected based on USE_SPOT)
# Spot: raw value / 595.24 (empirically determined)
# Perp: raw value / 10^4 (standard formula)
HC_DECIMALS=4

# ==============================================================================
# ORACLE CONFIGURATION
# ==============================================================================

# Pyth Network contract on HyperEVM mainnet
PYTH_ADDR=0xe9d69CdD6Fe41e7B621B4A688C5D1a68cB5c8ADc

# Pyth price feed IDs
# Note: These are tentative - verify with Pyth Network for latest feeds
PYTH_BASE_FEED_ID=4279e31cc369bbcc2faf022b382b080e32a8e689ff20fbc530d2a603eb6cd98b    # HYPE/USD
PYTH_QUOTE_FEED_ID=eaa020c61cc479712813461ce153894a96a6c00b21ed0cfc2798d1f9a9e9c94a   # USDC/USD (verified)

# Direct pair feed (if available - currently not confirmed for HYPE/USDC)
PYTH_PAIR_FEED_ID=

# ==============================================================================
# SIMULATION PARAMETERS
# ==============================================================================

# Sampling interval in milliseconds (5 seconds recommended for production)
INTERVAL_MS=5000

# Output CSV file path
OUT_CSV=hype_usdc_shadow_enterprise.csv

# Prometheus metrics port
PROM_PORT=9464

# ==============================================================================
# DECISION THRESHOLDS (TUNABLE)
# ==============================================================================

# Delta thresholds (in basis points)
ACCEPT_BPS=30                  # <= 30 bps: ACCEPT trades normally
SOFT_BPS=50                    # 31-50 bps: HAIR_CUT (increase fees)
HARD_BPS=75                    # > 75 bps: REJECT trades

# Hysteresis frames for recovery from rejection state
HYSTERESIS_FRAMES=3            # Need 3 consecutive good frames to recover

# ==============================================================================
# ORACLE CONFIGURATION PARAMETERS
# ==============================================================================

# Freshness limits
MAX_AGE_SEC=60                 # Maximum age for oracle prices (1 minute)
STALL_WINDOW_SEC=120          # Maximum staleness for EMA fallback (2 minutes)

# Confidence caps (basis points)
CONF_CAP_BPS_SPOT=100          # Cap for spot trading mode
CONF_CAP_BPS_STRICT=80         # Cap for strict mode (RFQ)
MAX_CONF_BPS=80                # Maximum Pyth confidence to accept

# Divergence threshold
DIVERGENCE_BPS=75              # Max allowed HC vs Pyth divergence (0.75%)

# EMA fallback
ALLOW_EMA_FALLBACK=true        # Allow EMA as fallback when primary stale

# Confidence weights (sum should be ~10000)
CONF_WEIGHT_SPREAD_BPS=3000    # Weight for spread-based confidence (30%)
CONF_WEIGHT_SIGMA_BPS=4000     # Weight for volatility-based confidence (40%)
CONF_WEIGHT_PYTH_BPS=3000      # Weight for Pyth confidence (30%)

# Volatility EWMA lambda
SIGMA_EWMA_LAMBDA_BPS=100      # Lambda for sigma EWMA (1% = slow adaptation)

# ==============================================================================
# INVENTORY CONFIGURATION
# ==============================================================================

# Inventory floor (minimum reserves to maintain)
INVENTORY_FLOOR_BPS=1000       # 10% floor - never trade below this

# Target base inventory (in WAD = 1e18)
# For HYPE: 10,000 HYPE target
INVENTORY_TARGET_BASE=10000000000000000000000

# Recenter threshold
INVENTORY_RECENTER_PCT=500     # 5% deviation triggers recenter consideration

# ==============================================================================
# FEE CONFIGURATION
# ==============================================================================

# Base fee
FEE_BASE_BPS=10                # 0.1% base fee

# Alpha (confidence-based fee component)
FEE_ALPHA_NUM=1                # Numerator for α
FEE_ALPHA_DENOM=100           # Denominator for α
                              # Result: +1 bps fee per 100 bps confidence

# Beta (inventory-based fee component)
FEE_BETA_NUM=1                 # Numerator for β
FEE_BETA_DENOM=200            # Denominator for β
                              # Result: +1 bps fee per 200 bps inventory deviation

# Fee cap
FEE_CAP_BPS=100                # 1% maximum fee

# Fee decay rate
FEE_DECAY_RATE=10              # Decay rate per block

# ==============================================================================
# ADVANCED CONFIGURATION
# ==============================================================================

# Enable debug mode (verbose logging)
DEBUG=false

# Enable trade simulation
SIMULATE_TRADES=true
TRADE_PROBABILITY=0.1          # 10% chance per sample to simulate a trade

# Data retention
MAX_HISTORY_SIZE=100           # Keep last 100 samples in memory for analysis

# ==============================================================================
# MONITORING & ALERTING
# ==============================================================================

# Alert thresholds
ALERT_DELTA_BPS=100           # Alert if delta exceeds 1%
ALERT_INVENTORY_DEV_BPS=2000  # Alert if inventory deviation exceeds 20%
ALERT_REJECT_DURATION_SEC=60  # Alert if rejection lasts longer than 1 minute
ALERT_SPREAD_BPS=100          # Alert if spread exceeds 1%
ALERT_CONF_BPS=90             # Alert if confidence exceeds 0.9%

# Webhook for alerts (optional - add your Slack/Discord webhook)
ALERT_WEBHOOK_URL=

# ==============================================================================
# HYPERLIQUID SPECIFIC SETTINGS
# ==============================================================================

# Market information
MARKET_SYMBOL=HYPE/USDC       # Human-readable market name
MARKET_TYPE=spot              # spot or perp
SPOT_PAIR_INDEX=107           # HYPE/USDC spot pair index (@107)
TOKEN_INDEX=150               # HYPE token index

# HyperCore Oracle Precompiles (HyperEVM specific)
ORACLE_PX=0x0000000000000000000000000000000000000807      # Price oracle
ORACLE_AGE=0x0000000000000000000000000000000000000806     # Age oracle
ORACLE_EMA=0x0000000000000000000000000000000000000808     # EMA oracle
BBO=0x000000000000000000000000000000000000080e           # Best bid/offer

# ==============================================================================
# NOTES
# ==============================================================================
#
# 1. HYPE/USDC is a relatively new market (launched Sept 2024)
# 2. Primary liquidity is on Hyperliquid spot, not external venues
# 3. HyperCore oracles provide direct on-chain price feeds
# 4. Pyth feed availability for HYPE is still being verified
# 5. Adjust thresholds based on observed market behavior
#
# To optimize parameters:
# - Run for 3-7 days to collect baseline data
# - Analyze with: npm run analyze hype_usdc_shadow_enterprise.csv
# - Adjust ACCEPT_BPS/SOFT_BPS/HARD_BPS based on reject rates
# - Fine-tune confidence weights based on market volatility